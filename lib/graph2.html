<!DOCTYPE html>
<meta charset="utf-8">
<style>

.node {
  stroke: #fff;
  stroke-width: 1.5px;
}
.node text {
  pointer-events: none;
  font: 30px sans-serif;
}

.link {
  stroke: #999;
  stroke-opacity: .6;
}

</style>
<body>
<script src="//d3js.org/d3.v3.min.js"></script>
<script>

var width = 960,
    height = 500;
    radius = 10;

var color = d3.scale.category20();

var force = d3.layout.force()
    .charge(-50)
    .linkDistance(100)
    .size([width, height]);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

var drag = force.drag()
    .on("dragstart", dragstart);
var xScale = d3.scale.linear()
                     .domain([1, 75])
                     .range([0.1, 0.2]);

var nodes
var graph
var links
var noders
var linkers
// ABH4G7TVI6G2T
d3.json("connected_comp.json", function(error, graph) {
  if (error) throw error;

  force
      .nodes(graph.nodes)
      .links(graph.links)
       .alpha(0)
      .start();
  d3.selec
  link = svg.selectAll(".link")
      .data(graph.links)
    .enter().append("line")
      .attr("class", "link")
      .style("stroke-width", 0.1);

   node = svg.selectAll(".node")
      .data(graph.nodes)
    .enter().append("circle")
      .attr("class", "node")
      .attr("type", function(d) { return d.desc;})
      .attr("name", function(d) { return d.id;})
      .attr("neigh", function(d) { return +d.neigh;})

      .attr("r",function(d) { 
            if(d.id == "The Aviator" ){return 7;}
            if(d.id == "American Beauty" ){return 7;}
            if(d.id == "District 9" ){return 7;}
            if(d.id == "The Hurt Locker" ){return 7;}
            if(d.id == "Up" ){return 7;}
            if(d.id == "The Departed" ){return 7;}
            if(d.id == "The Insider" ){return 7;}
            if(d.id == "Borat" ){return 7;}
            if(d.id == "B004FM2ENU" ){return 7;}
            else if (+d.neigh == 1){return 7;} 
            if(d.id == "B004FM2ENU" ){return 10;}

            if (d.desc == "movies") {return 5;} 
            else {return 4;}}) 
      .style("fill", function(d) { 
        //AV6QDP8Q0ONK4
            if(d.id == "The Aviator" ){return "#800080";}
            if(d.id == "American Beauty" ){return "#800080";}
            if(d.id == "District 9" ){return "#800080";}
            if(d.id == "The Hurt Locker" ){return "#800080";}
            if(d.id == "Up" ){return "#43C6DB";}
            if(d.id == "The Departed" ){return "#43C6DB";}
            if(d.id == "The Insider" ){return "#43C6DB";}
            if(d.id == "Borat" ){return "#43C6DB";}
            if(d.id == "Borat" ){return "#43C6DB";}

            if(d.id == "B004FM2ENU" ){return "orange";}
            if(d.id == "A1J2931UBBJPXM" ){return "blue";}
            else if (+d.neigh == 1){return "#B8860B";} 
            else if (+d.neigh == 57){return "black";} 

            else if (d.desc == "movies") {return "green";} 
            else if (d.desc == "oscar") {return "#FFD700";} 
            else {return "red";}})
      .on("dblclick", dblclick)
      .call(drag);

    node.append("title")
      .attr("dx", ".10em")
      .attr("dy",  ".10em")
      .text(function(d) {return d.name; });

  // node.append("title")
  //     .text(function(d) { return d.id; });
var noders = svg.selectAll(".node"),
    linkers = svg.selectAll(".link");

  svg.selectAll("circle")
        .on("mouseover", function(){ output = d3.select(this)[0][0].attributes.name
          output2 = d3.select(this)[0][0].attributes.neigh.value
          svg.append("text")
          .attr("x", (width*8/ 10))             
          .attr("y", 20)
          .attr("text-anchor", "middle")  
          .style("font-size", "12px") 
          .style("text-decoration", "underline")  
          .text(output.value + "  " + output2);
          })
        .on("mouseout", function(){svg.selectAll("text").remove();})

        //     

  force.on("tick", function() {
    link.attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; });
    node.attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; });
    // node.attr("cx", function(d) { return d.x = Math.max(radius, Math.min(width - radius, d.x)); })
    //     .attr("cy", function(d) { return d.y = Math.max(radius, Math.min(height - radius, d.y)); });
    // node.attr("cx", function(d) { return 300; })
    //     .attr("cy", function(d) { return 400; });
  });
});
var output
function dblclick(d) {
  d3.select(this).classed("fixed", d.fixed = false);
}

function dragstart(d) {
  d3.select(this).classed("fixed", d.fixed = true);
}
</script>